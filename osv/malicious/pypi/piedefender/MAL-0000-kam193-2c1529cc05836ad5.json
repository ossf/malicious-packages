{
  "modified": "2025-03-01T15:16:30Z",
  "published": "2025-03-01T15:16:30Z",
  "schema_version": "1.7.4",
  "id": "",
  "summary": "Malicious code in piedefender (PyPI)",
  "details": "setup.py is prepared to download and run an obfuscated batch script. While the script is not detected by any AV currently, in the sandbox analysis it reveals behaviour like adding exclusions to Windows Defender\n\n\n---\n\nCategory: MALICIOUS - The campaign has clearly malicious intent, like infostealers.\nCampaign: 2025-02-pydefender\nReasons (based on the campaign):\n - Downloads and executes a remote malicious script.\n - malware\n - The package overrides the install command in setup.py to execute malicious code during installation.",
  "affected": [
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "piedefender"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "EVIDENCE",
      "url": "https://www.virustotal.com/gui/file/0877653f6a24639bb02b547c94f670597c3c0cd96df910a2ac891eaeaa9cc5f3/behavior"
    },
    {
      "type": "EVIDENCE",
      "url": "https://tria.ge/250301-sdh1pstrz7/behavioral1"
    },
    {
      "type": "EVIDENCE",
      "url": "https://app.any.run/tasks/0fbdb4f9-0497-4272-baf0-872e8d6e50bc"
    },
    {
      "type": "WEB",
      "url": "https://bad-packages.kam193.eu/pypi/package/piedefender"
    }
  ],
  "credits": [
    {
      "name": "Kamil Ma≈Ñkowski (kam193)",
      "contact": [
        "https://github.com/kam193",
        "https://bad-packages.kam193.eu/"
      ]
    }
  ],
  "database_specific": {
    "iocs": {
      "urls": [
        "https://raw.githubusercontent.com/baledreamer/payload/refs/heads/main/smegma.bat"
      ]
    },
    "malicious-packages-origins": [
      {
        "source": "kam193",
        "sha256": "2c1529cc05836ad53ce1822ee0e8da4790aa1ce9d219d1b00e70ced2cb8798fe",
        "import_time": "2025-12-02T22:30:55.427439345Z",
        "id": "pypi/2025-02-pydefender/piedefender",
        "modified_time": "2025-03-01T15:16:30Z",
        "ranges": [
          {
            "type": "ECOSYSTEM",
            "events": [
              {
                "introduced": "0"
              }
            ]
          }
        ]
      }
    ]
  }
}
