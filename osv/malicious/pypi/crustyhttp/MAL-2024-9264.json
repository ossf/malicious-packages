{
  "modified": "2025-12-03T00:04:26Z",
  "published": "2024-08-29T10:57:16Z",
  "schema_version": "1.7.4",
  "id": "MAL-2024-9264",
  "summary": "Malicious code in crustyhttp (PyPI)",
  "details": "Base64-encoded commands are executed from __init__.py, which exfiltrate Telegram session data.\n\n---\n_-= Per source details. Do not edit below this line.=-_\n\n## Source: kam193 (806b071147126057a7de9b570f85f694ad06923e4d580ddd5274731b5343f556)\nIn the invokehttp, the __init__.py contains obfuscated code attempting to download and run one of two executables. They are identified as malicious by VT and the tracks of Telegram URLs suggests attempting data exfiltration. The package itself looks like a copy of requests.\nIn flophttp, using exactly the same obfuscation method, the infostealer is directly embeded into package code and exfiltrates data to a telegram channel.\n\n\n---\n\nCategory: MALICIOUS - The campaign has clearly malicious intent, like infostealers.\n\n\nCampaign: 2024-08-invokehttp\n\n\nReasons (based on the campaign):\n\n\n - infostealer\n\n\n - Downloads and executes a remote executable.\n\n\n - obfuscation\n\n\n - clones-real-package\n",
  "affected": [
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "crustyhttp"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            }
          ]
        }
      ],
      "versions": [
        "1.3.5"
      ]
    }
  ],
  "references": [
    {
      "type": "EVIDENCE",
      "url": "https://www.virustotal.com/gui/file/84ccffd89ef262ce8475801bfc751fec381ee613f38f78b1c0974716ad32bab8"
    },
    {
      "type": "EVIDENCE",
      "url": "https://www.virustotal.com/gui/file/6c2fb04f81fe0631d6765720af92aa9969f10766281fbc32b6f77889b50b87cd"
    },
    {
      "type": "WEB",
      "url": "https://bad-packages.kam193.eu/pypi/package/crustyhttp"
    }
  ],
  "credits": [
    {
      "name": "Kamil Mańkowski (kam193)",
      "contact": [
        "https://github.com/kam193",
        "https://bad-packages.kam193.eu/"
      ]
    },
    {
      "name": "Kamil Mańkowski (kam193)",
      "type": "REPORTER",
      "contact": [
        "https://github.com/kam193",
        "https://bad-packages.kam193.eu/"
      ]
    },
    {
      "name": "Stacklok: trustypkg.dev",
      "type": "FINDER",
      "contact": [
        "https://discord.com/invite/RkzVuTp3WK"
      ]
    }
  ],
  "database_specific": {
    "iocs": {
      "urls": [
        "https://github.com/user-attachments/files/16791956/marshal.txt",
        "https://github.com/user-attachments/files/16791996/trezznor.txt"
      ]
    },
    "malicious-packages-origins": [
      {
        "source": "kam193",
        "sha256": "601f1a02d8f90bb5fa384606dc1bb82ada74ffcf006654a9c17e3f09294f4e4e",
        "import_time": "2025-12-02T22:30:55.077659978Z",
        "id": "pypi/2024-08-invokehttp/crustyhttp",
        "modified_time": "2024-08-29T10:57:16Z",
        "ranges": [
          {
            "type": "ECOSYSTEM",
            "events": [
              {
                "introduced": "0"
              }
            ]
          }
        ]
      },
      {
        "source": "kam193",
        "sha256": "806b071147126057a7de9b570f85f694ad06923e4d580ddd5274731b5343f556",
        "import_time": "2025-12-02T23:07:18.087464517Z",
        "id": "pypi/2024-08-invokehttp/crustyhttp",
        "modified_time": "2024-08-29T10:57:16Z",
        "ranges": [
          {
            "type": "ECOSYSTEM",
            "events": [
              {
                "introduced": "0"
              }
            ]
          }
        ]
      }
    ]
  }
}
